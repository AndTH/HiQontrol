#:kivy 1.0.9

#:import FallOutTransition kivy.uix.screenmanager.FallOutTransition
#:import RiseInTransition kivy.uix.screenmanager.RiseInTransition

<HiQontrol>:
    HomeScreen:
    MixScreenProto:

<HomeScreen>:
    id: home
    infos: infos.__self__
    add: add.__self__
    rem: rem.__self__
    about: about.__self__
    name: 'home'

    # TODO: Add an appealing background. Perhaps similar to the splashscreen.

    Popup:
        id: about
        title: "About " + app.title
        size_hint: .75, .75
        on_parent:
            if self.parent == home: self.parent.remove_widget(self)

        BoxLayout:
            orientation: 'vertical'

            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None

                Label:
                    text: "A HiQnet controller for Soundcraft Si Compact 16 digital mixing consoles"

                Label:
                    text: "Version " + app.__version__ + " - Copyright (C) 2014 RaphaÃ«l Doursenaud"

            GridLayout:
                cols: 2

                Label:
                    size_hint_x: .5
                    text: "Name:"

                TextInput:
                    text: app.getLocalName()
                    disabled: True # TODO: allow changing

                Label:
                    size_hint_x: .5
                    text: "HiQnet Address:"

                TextInput:
                    text: app.getLocalHiQNetAddress()
                    disabled: True # TODO: allow changing

                Label:
                    size_hint_x: .5
                    text: "MAC Address:"

                TextInput:
                    text: app.getLocalMACAddress()
                    disabled: True

                Label:
                    size_hint_x: .5
                    text: "DHCP:"

                CheckBox:
                    active: app.getLocalDHCPStatus()
                    disabled: True

                Label:
                    size_hint_x: .5
                    text: "IP Address:"

                TextInput:
                    text: app.getLocalIPAddress()
                    disabled: True

                Label:
                    size_hint_x: .5
                    text: "Subnet Mask:"

                TextInput:
                    text: app.getLocalSubnetMask()
                    disabled: True
                Label:
                    size_hint_x: .5
                    text: "Gateway:"

                TextInput:
                    text: app.getLocalGateway()
                    disabled: True

            Button:
                text: "OK"
                size_hint_y: None
                on_press: about.dismiss()

    Popup:
        id: infos
        title: "Device informations"
        size_hint: .75, .75
        on_parent:
            if self.parent == home: self.parent.remove_widget(self)

        BoxLayout:
            orientation: 'vertical'

            GridLayout:
                cols: 2

                Label:
                    size_hint_x: .5
                    text: "IP Address:"

                TextInput:
                    text: app.getIPAddress()
                    disabled: True

                Label:
                    size_hint_x: .5
                    text: "HiQnet Address:"

                TextInput:
                    text: app.getHiQnetAddress()
                    disabled: True

            Button:
                text: "OK"
                size_hint_y: None
                on_press: infos.dismiss()

    Popup:
        id: add
        title: "Add a device"
        size_hint: .75, .75
        on_parent:
            if self.parent == home: self.parent.remove_widget(self)

        BoxLayout:
            orientation: 'vertical'

            GridLayout:
                cols: 2

                Label:
                    text: "Model:"
                    size_hint_x: .5
                # TODO: maybe replace by a dropdown list
                TextInput:
                    text: "Si Compact 16"
                    disabled: True

                Label:
                    text: "HiQnetAddress:"
                    size_hint_x: .5
                TextInput:
                    # TODO: number input only

            Button:
                text: "Add"
                size_hint_y: None
                on_press:
                    add.dismiss()
                    # TODO: do something useful

    Popup:
        size_hint: .75, .75
        id: rem
        title: "Remove a device"
        on_parent:
            if self.parent == home: self.parent.remove_widget(self)

        BoxLayout:
            orientation: 'vertical'
            Label:
                text: "Are you sure?"

            BoxLayout:
                size_hint_y: None
                Button:
                    text: "No"
                    on_press: rem.dismiss()

                Button:
                    text: "Yes"
                    on_press:
                        rem.dismiss()
                        # TODO: do something useful

    BoxLayout:
        orientation: 'vertical'

        ActionBar:
            size_hint_y: None

            ActionView:

                ActionPrevious:
                    app_icon: 'assets/icon.png'
                    title: 'Home'
                    with_previous: False
                ActionButton:
                    text: 'About'  # TODO: replace by a nice icon
                    on_press: root.about.open()

        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            padding: 100

            BoxLayout:
                orientation: 'vertical'

                GridLayout:
                    id: device_list
                    # TODO: maybe replace by a ListView?
                    cols: 3

                    Button:
                        text: "Si Compact 16"
                        on_press:
                            root.manager.transition = FallOutTransition()
                            root.manager.current = 'mix'

                    ToggleButton:
                        size_hint_x: None
                        text: "L"  # TODO: replace by a nice icon
                        on_press: app.locateToggle()

                    Button:
                        size_hint_x: None
                        text: "i"  # TODO: replace by a nice icon
                        on_press: root.infos.open()

                BoxLayout:
                    size_hint_y: None
                    Button:
                        text: "-"  # TODO: replace by a nice icon
                        on_press: root.rem.open()
                    Button:
                        text: "+"  # TODO: replace by a nice icon
                        on_press: root.add.open()


<MixScreenProto>
    name: 'mix'

    BoxLayout:
        orientation: 'vertical'

        ActionBar:
            size_hint_y: None

            ActionView:

                ActionPrevious:
                    app_icon: 'assets/icon.png'
                    title: 'Mix'
                    on_release:
                        root.manager.transition = RiseInTransition()
                        root.manager.current = 'home'

        # TODO: make this layout generative according to the console's description file
        GridLayout:
            cols: 9

            TextInput:
                text: "1"
                size_hint_y: None

            TextInput:
                text: "2"
                size_hint_y: None

            TextInput:
                text: "3"
                size_hint_y: None

            TextInput:
                text: "4"
                size_hint_y: None

            TextInput:
                text: "5"
                size_hint_y: None

            TextInput:
                text: "6"
                size_hint_y: None

            TextInput:
                text: "7"
                size_hint_y: None

            TextInput:
                text: "8"
                size_hint_y: None

            TextInput:
                text: "L & R"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            ToggleButton:
                text: "ON"
                size_hint_y: None

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Slider:
                orientation: 'vertical'

            Label:
                text: "1"
                size_hint_y: None

            Label:
                text: "2"
                size_hint_y: None

            Label:
                text: "3"
                size_hint_y: None

            Label:
                text: "4"
                size_hint_y: None

            Label:
                text: "5"
                size_hint_y: None

            Label:
                text: "6"
                size_hint_y: None

            Label:
                text: "7"
                size_hint_y: None

            Label:
                text: "8"
                size_hint_y: None

            Label:
                text: "L & R"
                size_hint_y: None
